<!DOCTYPE html>
<html lang="de" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jarvis — MindHome Dashboard</title>
<style>
/* ============================================================
   MindHome Design System — J.A.R.V.I.S. HUD Interface
   Cyan-blue holographic, dark tactical background
   ============================================================ */
/* Offline-Fonts: System-Fonts statt Google CDN (Offline-Prinzip) */
@font-face {
  font-family: 'Outfit';
  font-style: normal;
  font-weight: 300 700;
  font-display: swap;
  src: local('Outfit'), local('Inter'), local('Segoe UI');
}
@font-face {
  font-family: 'JetBrains Mono';
  font-style: normal;
  font-weight: 400 500;
  font-display: swap;
  src: local('JetBrains Mono'), local('SF Mono'), local('Consolas'), local('Menlo');
}

:root {
  --bg-primary: #040810;
  --bg-secondary: #0a1018;
  --bg-card: #0c1520;
  --bg-card-hover: #111e2e;
  --bg-input: #081018;
  --bg-overlay: rgba(4, 8, 16, 0.9);
  --text-primary: #c8dce8;
  --text-secondary: #6889a0;
  --text-muted: #3a5568;
  --accent: #00d4ff;
  --accent-dim: rgba(0, 212, 255, 0.1);
  --accent-glow: rgba(0, 212, 255, 0.35);
  --blue: #00d4ff;
  --blue-dim: rgba(0, 212, 255, 0.1);
  --success: #00e676;
  --success-dim: rgba(0, 230, 118, 0.12);
  --danger: #ff3d3d;
  --danger-dim: rgba(255, 61, 61, 0.12);
  --border: rgba(0, 212, 255, 0.06);
  --border-hover: rgba(0, 212, 255, 0.15);
  --border-accent: rgba(0, 212, 255, 0.25);
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.5);
  --shadow-md: 0 4px 16px rgba(0,0,0,0.6);
  --shadow-lg: 0 8px 32px rgba(0,0,0,0.7);
  --shadow-glow: 0 0 30px rgba(0, 212, 255, 0.15);
  --radius-sm: 4px;
  --radius-md: 6px;
  --radius-lg: 8px;
  --font: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
  --mono: 'JetBrains Mono', 'SF Mono', monospace;
  --sidebar-w: 220px;
  --header-h: 56px;
  --fast: 0.15s ease;
  --normal: 0.25s ease;
}

* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:var(--font); background:var(--bg-primary); color:var(--text-primary); min-height:100vh; overflow-x:hidden; background-image: radial-gradient(circle at 20% 50%, rgba(0,212,255,0.015) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(0,212,255,0.01) 0%, transparent 40%); }

/* ---- Login HUD ---- */
.login-screen { display:flex; align-items:center; justify-content:center; min-height:100vh; background: radial-gradient(ellipse at center, rgba(0,212,255,0.04) 0%, var(--bg-primary) 70%); overflow: hidden; }
.login-box { background: rgba(8,16,28,0.92); border: 1px solid var(--border-accent); border-radius:var(--radius-lg); padding:48px 40px; width:360px; text-align:center; box-shadow: var(--shadow-lg), var(--shadow-glow), inset 0 1px 0 rgba(0,212,255,0.1); position: relative; backdrop-filter: blur(16px); }
.login-box h1 { font-size:28px; font-weight:600; margin-bottom:8px; color:var(--accent); letter-spacing: 6px; text-shadow: 0 0 30px rgba(0,212,255,0.5), 0 0 60px rgba(0,212,255,0.2); }
.login-box p { color:var(--text-secondary); margin-bottom:32px; font-size:14px; text-transform: uppercase; letter-spacing: 3px; font-family: var(--mono); }
.login-box input { width:100%; padding:14px 16px; background:rgba(0,212,255,0.03); border:1px solid var(--border-accent); border-radius:var(--radius-sm); color:var(--accent); font-family:var(--mono); font-size:24px; text-align:center; letter-spacing:12px; outline:none; transition: border-color var(--fast), box-shadow var(--fast); }
.login-box input:focus { border-color:var(--accent); box-shadow: 0 0 25px rgba(0,212,255,0.2), inset 0 0 15px rgba(0,212,255,0.05); }
.login-box input::placeholder { letter-spacing:4px; font-size:14px; color:var(--text-muted); }
.login-box button { width:100%; margin-top:20px; padding:14px; background:transparent; color:var(--accent); border:1px solid var(--accent); border-radius:var(--radius-sm); font-family:var(--font); font-size:16px; font-weight:600; cursor:pointer; text-transform: uppercase; letter-spacing: 3px; transition: all var(--fast); box-shadow: 0 0 15px rgba(0,212,255,0.1), inset 0 0 15px rgba(0,212,255,0.05); }
.login-box button:hover { background:rgba(0,212,255,0.1); box-shadow: 0 0 30px rgba(0,212,255,0.3), inset 0 0 20px rgba(0,212,255,0.1); }
.login-error { color:var(--danger); font-size:13px; margin-top:12px; min-height:20px; text-shadow: 0 0 10px rgba(255,61,61,0.3); }
.login-icon { font-size:44px; margin-bottom:14px; }
.login-box input + input { margin-top:12px; }
.login-box .recovery-hint { color:var(--accent); font-weight:600; margin-bottom:16px; text-shadow: 0 0 15px rgba(0,212,255,0.3); }
.login-box .recovery-desc { margin-bottom:20px; font-size:13px; }
.login-box .recovery-key-display { background:rgba(0,212,255,0.03); border:1px solid var(--accent); border-radius:var(--radius-sm); padding:18px; font-family:var(--mono); font-size:22px; letter-spacing:4px; color:var(--accent); margin-bottom:20px; user-select:all; text-shadow: 0 0 10px rgba(0,212,255,0.4); box-shadow: 0 0 20px rgba(0,212,255,0.1), inset 0 0 20px rgba(0,212,255,0.03); }
.login-box .forgot-pin { margin-top:20px; }
.login-box .forgot-pin a { color:var(--text-muted); font-size:12px; text-decoration:none; }
.login-box .forgot-pin a:hover { color:var(--accent); text-shadow: 0 0 10px rgba(0,212,255,0.3); }
.login-box .reset-input { margin-bottom:12px; letter-spacing:2px; text-transform:uppercase; }
.login-hud-ring { position: absolute; top: -60px; left: 50%; transform: translateX(-50%); width: 120px; height: 120px; }
.login-hud-ring svg { width: 100%; height: 100%; animation: hudSpin 8s linear infinite; }
.login-hud-arc { fill: none; stroke: var(--accent); stroke-width: 1.5; stroke-dasharray: 40 20; opacity: 0.6; filter: drop-shadow(0 0 4px rgba(0,212,255,0.5)); }
.login-hud-arc-inner { fill: none; stroke: rgba(0,212,255,0.3); stroke-width: 1; stroke-dasharray: 15 25; opacity: 0.4; }
.login-scan-line { position: absolute; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--accent), transparent); opacity: 0.4; animation: scanDown 3s ease-in-out infinite; filter: drop-shadow(0 0 6px rgba(0,212,255,0.6)); }
.login-corner { position: absolute; width: 16px; height: 16px; border-color: var(--accent); opacity: 0.5; }
.login-corner.tl { top: 8px; left: 8px; border-top: 1px solid; border-left: 1px solid; }
.login-corner.tr { top: 8px; right: 8px; border-top: 1px solid; border-right: 1px solid; }
.login-corner.bl { bottom: 8px; left: 8px; border-bottom: 1px solid; border-left: 1px solid; }
.login-corner.br { bottom: 8px; right: 8px; border-bottom: 1px solid; border-right: 1px solid; }
@keyframes hudSpin { to { transform: rotate(360deg); } }
@keyframes scanDown { 0%,100% { top: 10%; } 50% { top: 90%; } }

/* ---- App ---- */
.app { display:none; }
.app.active { display:flex; min-height:100vh; }

/* Sidebar */
.sidebar { width:var(--sidebar-w); background:var(--bg-secondary); border-right:1px solid rgba(0,212,255,0.1); display:flex; flex-direction:column; position:fixed; top:0; left:0; bottom:0; z-index:100; overflow:hidden; }
.sidebar::before { content:''; position:absolute; top:0; left:0; right:0; bottom:0; background:linear-gradient(180deg, rgba(0,212,255,0.03) 0%, transparent 40%, transparent 60%, rgba(0,212,255,0.02) 100%); pointer-events:none; z-index:0; }
.sidebar::after { content:''; position:absolute; left:0; right:0; height:1px; background:linear-gradient(90deg, transparent, rgba(0,212,255,0.6), transparent); opacity:0.2; animation:sidebarScan 6s ease-in-out infinite; pointer-events:none; z-index:1; filter: drop-shadow(0 0 4px rgba(0,212,255,0.4)); }
@keyframes sidebarScan { 0%,100% { top:5%; } 50% { top:95%; } }
.sidebar-logo { padding:18px 20px; border-bottom:1px solid rgba(0,212,255,0.12); display:flex; align-items:center; gap:12px; position:relative; z-index:2; }
.sidebar-logo .logo-icon { width:36px; height:36px; border:1.5px solid var(--accent); border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:16px; font-weight:700; color:var(--accent); font-family:var(--mono); box-shadow:0 0 15px rgba(0,212,255,0.3), inset 0 0 10px rgba(0,212,255,0.15); animation:logoGlow 3s ease-in-out infinite; }
@keyframes logoGlow { 0%,100% { box-shadow:0 0 15px rgba(0,212,255,0.3), inset 0 0 10px rgba(0,212,255,0.15); } 50% { box-shadow:0 0 25px rgba(0,212,255,0.5), inset 0 0 15px rgba(0,212,255,0.2); } }
.sidebar-logo h2 { font-size:17px; font-weight:600; letter-spacing:4px; color:var(--accent); text-shadow: 0 0 20px rgba(0,212,255,0.4); }
.sidebar-logo span { font-size:9px; color:var(--text-muted); display:block; text-transform:uppercase; letter-spacing:2px; }
.sidebar-nav { padding:12px 8px; flex:1; overflow-y:auto; position:relative; z-index:2; }
.nav-item { display:flex; align-items:center; gap:10px; padding:10px 14px; border-radius:var(--radius-sm); color:var(--text-secondary); cursor:pointer; font-size:13px; font-weight:500; margin-bottom:2px; transition:all var(--fast); border:1px solid transparent; text-transform:uppercase; letter-spacing:0.5px; font-size:12px; }
.nav-item:hover { background:rgba(0,212,255,0.04); color:var(--text-primary); border-color:rgba(0,212,255,0.1); }
.nav-item.active { background:rgba(0,212,255,0.06); color:var(--accent); border-color:rgba(0,212,255,0.2); box-shadow:0 0 15px rgba(0,212,255,0.08); }
.nav-item.active::before { content:''; position:absolute; left:0; width:2px; height:24px; background:var(--accent); border-radius:0 2px 2px 0; box-shadow:0 0 10px var(--accent); }
.nav-item .nav-icon { width:18px; text-align:center; font-size:14px; }
.sidebar-footer { padding:12px; border-top:1px solid rgba(0,212,255,0.1); font-size:10px; color:var(--text-muted); text-align:center; position:relative; z-index:2; font-family:var(--mono); letter-spacing:1px; text-transform:uppercase; }

/* Main */
.main { margin-left:var(--sidebar-w); flex:1; min-height:100vh; overflow-x:hidden; max-width:100vw; }
.main-header { height:var(--header-h); border-bottom:1px solid rgba(0,212,255,0.1); display:flex; align-items:center; justify-content:space-between; padding:0 28px; background:rgba(8,14,24,0.95); backdrop-filter:blur(16px); position:sticky; top:0; z-index:50; }
.main-header::after { content:''; position:absolute; bottom:-1px; left:0; right:0; height:1px; background:linear-gradient(90deg, transparent, rgba(0,212,255,0.6), transparent); opacity:0.3; filter: drop-shadow(0 0 4px rgba(0,212,255,0.3)); }
.main-header h1 { font-size:15px; font-weight:600; text-transform:uppercase; letter-spacing:3px; color:var(--accent); text-shadow: 0 0 15px rgba(0,212,255,0.2); }
.main-content { padding:28px; overflow-x:hidden; }

/* ---- Responsive ---- */

/* Tablet (< 900px): Sidebar als Drawer */
@media (max-width:900px) {
  .sidebar { transform:translateX(-100%); transition:transform var(--normal); }
  .sidebar.open { transform:translateX(0); }
  .main { margin-left:0; }
  .mobile-toggle { display:flex !important; }
  .main-content { padding:20px; }
  .main-header { padding:0 16px; }
  .section-header { flex-direction:column; align-items:flex-start; gap:12px; }
  .section-header .err-filter-bar { width:100%; }
  .entity-filter-bar { grid-template-columns:1fr; }
  /* Sidebar nav groups: Touch-optimiert */
  .nav-group-header { padding:10px 14px; font-size:11px; min-height:40px; }
  .nav-group-items .nav-item { padding:10px 14px 10px 36px; min-height:40px; }
  /* HUD: Scan-Linie + Grid an mobiles Layout anpassen */
  .main::after { left:0; }
  .main-content::before { left:0; }
  /* Arc Reactor kleiner auf Tablet */
  .arc-reactor-bg { width:350px; height:350px; }
}

/* Phone (< 600px): Kompakteres Layout */
@media (max-width:600px) {
  .main-content { padding:14px; }
  .main-header { padding:0 12px; height:48px; }
  .main-header h1 { font-size:13px; letter-spacing:2px; }
  .card { padding:14px; margin-bottom:12px; }
  .stat-value { font-size:22px; }
  .stat-card { padding:14px 16px; }
  .section-header h2 { font-size:14px; letter-spacing:2px; }
  .section-header p { font-size:10px; }
  .btn { padding:8px 14px; font-size:11px; }
  .btn-sm { padding:5px 10px; }
  /* Nav-Items: groessere Touch-Targets */
  .nav-item { padding:12px 14px; font-size:12px; min-height:44px; }
  /* Login auf kleinen Screens */
  .login-box { width:calc(100vw - 32px); max-width:360px; padding:36px 24px; }
  .login-box h1 { font-size:24px; letter-spacing:4px; }
  .login-box input { font-size:20px; padding:12px 14px; }
  .login-hud-ring { width:100px; height:100px; top:-50px; }
  /* Log entries: Stack statt Zeile */
  .log-entry { flex-direction:column; gap:4px; padding:10px 12px; }
  .log-time { min-width:unset; font-size:10px; }
  .log-role { min-width:unset; }
  .log-content { font-size:13px; }
  /* Error entries: Stack */
  .err-entry { flex-direction:column; gap:4px; padding:10px 12px; }
  .err-time { min-width:unset; }
  .err-level { min-width:unset; }
  .err-logger { min-width:unset; max-width:100%; }
  /* Audit entries: Stack */
  .audit-entry { flex-direction:column; gap:4px; padding:10px 12px; }
  .audit-time { min-width:unset; }
  .audit-action { min-width:unset; width:fit-content; }
  /* Trend rows kompakter */
  .trend-row { flex-wrap:wrap; gap:8px; }
  .trend-label { min-width:80px; font-size:10px; }
  .trend-value { font-size:16px; min-width:60px; }
  /* Error filter bar */
  .err-filter-bar { gap:6px; }
  .err-filter-bar .btn { padding:6px 10px; font-size:10px; }
  /* Help modal: volle Breite auf Phone */
  .help-modal { padding:20px; max-width:100vw; width:calc(100vw - 24px); }
  .help-modal h3 { font-size:13px; }
  .help-btn { width:18px; height:18px; font-size:10px; }
  /* Toast unten mittig */
  .toast { left:16px; right:16px; bottom:16px; text-align:center; }
  /* Grid 2 auch auf Phone single column */
  .grid-2 { grid-template-columns:1fr; }
  /* Boot screen: kleiner */
  .boot-hud { width:200px; height:200px; }
  .boot-logo { font-size:24px; letter-spacing:6px; }
  .boot-text { font-size:11px; letter-spacing:2px; }
  .boot-systems { flex-wrap:wrap; justify-content:center; gap:8px; }
  /* Knowledge stats */
  .grid-3 { grid-template-columns:1fr; }
  /* Chip grid: besser wrappen */
  .chip-grid { gap:4px; }
  .chip-opt { padding:5px 10px; font-size:10px; }
  /* Collapsible sections */
  .s-section-hdr { padding:12px 14px; }
  .s-section-body.open { padding:14px; }
  .s-section-hdr h3 { font-size:12px; }
  /* HUD Brackets kleiner auf Mobile */
  .s-section::before { width:10px; height:10px; }
  .s-section::after { width:10px; height:10px; }
  /* Form elements */
  .form-group label { font-size:10px; }
  input[type="text"],input[type="number"],input:not([type]),select,textarea { font-size:14px; padding:10px 12px; max-width:100%; }
  /* Grid-Kinder: min-width:0 verhindert Overflow */
  .pt-row > *, .st-row > *, .kv-row > * { min-width:0; }
  .entity-pick-wrap { min-width:0; }
  .s-section-body { overflow-x:hidden; }
  .form-group { overflow-x:hidden; }
  /* Range: groesserer Thumb fuer Touch */
  .range-group input[type="range"]::-webkit-slider-thumb { width:22px; height:22px; }
  .range-value { font-size:13px; }
  /* Toggle: groesseres Touch Target */
  .toggle { width:48px; height:26px; }
  .toggle-thumb { width:20px; height:20px; }
  .toggle input:checked ~ .toggle-thumb { left:24px; }
  /* Arc Reactor: kleiner + weniger opak auf Phone */
  .arc-reactor-bg { width:280px; height:280px; opacity:0.3; }
  #page-dashboard::before { width:400px; height:400px; }
  /* Holographic Grid: leichter auf Mobile (Performance) */
  .main-content::before { background-size:50px 50px; }
  /* Buttons: volle Breite auf Mobile */
  .section-header .btn { width:100%; justify-content:center; }
}

/* Very small phones (< 380px) */
@media (max-width:380px) {
  .main-content { padding:10px; }
  .stat-value { font-size:18px; }
  .stat-card { padding:12px; }
  .login-box { padding:28px 16px; }
  .login-box h1 { font-size:20px; letter-spacing:3px; }
  .login-hud-ring { width:80px; height:80px; top:-40px; }
  .sidebar-logo h2 { font-size:15px; letter-spacing:3px; }
  /* Arc Reactor aus auf sehr kleinen Screens */
  .arc-reactor-bg { display:none; }
  /* Grid-Overlay aus (Performance) */
  .main-content::before { display:none; }
  /* Boot noch kleiner */
  .boot-hud { width:160px; height:160px; }
  .boot-logo { font-size:18px; letter-spacing:4px; }
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  .arc-ring-1, .arc-ring-2, .arc-ring-3,
  .boot-circle, .boot-ring-outer, .boot-ring-inner,
  .login-hud-ring svg,
  .sidebar::after, .main::after { animation:none !important; }
  .main-content::before { animation:none !important; }
  .stat-value { animation:none !important; }
  .login-box { animation:none !important; }
  #page-dashboard::before { animation:none !important; }
  .page { animation:none !important; }
}

/* Pages */
.page { display:none; overflow-x:hidden; max-width:100%; }
.page.active { display:block; }

/* Grid */
.grid { display:grid; gap:16px; }
.grid-2 { grid-template-columns:repeat(2,1fr); }
.grid-3 { grid-template-columns:repeat(3,1fr); }
.grid-4 { grid-template-columns:repeat(4,1fr); }
@media (max-width:1200px) { .grid-4 { grid-template-columns:repeat(2,1fr); } }
@media (max-width:900px) { .grid-2,.grid-3,.grid-4 { grid-template-columns:1fr; } }

/* Card */
.card { background:var(--bg-card); border:1px solid rgba(0,212,255,0.12); border-radius:var(--radius-md); padding:20px; margin-bottom:16px; position:relative; transition:all var(--normal); }
.card::before { content:''; position:absolute; top:0; left:0; right:0; height:1px; background:linear-gradient(90deg, transparent, rgba(0,212,255,0.4), transparent); border-radius:var(--radius-md) var(--radius-md) 0 0; }
.card:hover { border-color:var(--border-accent); box-shadow:0 0 20px rgba(0,212,255,0.08); }
.card-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; }
.card-header h3 { font-size:14px; font-weight:600; text-transform:uppercase; letter-spacing:1px; color:var(--accent); }

/* Stat */
.stat-card { background:var(--bg-card); border:1px solid rgba(0,212,255,0.12); border-radius:var(--radius-md); padding:18px 20px; position:relative; overflow:hidden; transition:all var(--normal); }
.stat-card::before { content:''; position:absolute; top:0; left:0; width:3px; height:100%; background:linear-gradient(180deg, var(--accent), transparent); border-radius:var(--radius-md) 0 0 var(--radius-md); }
.stat-card::after { content:''; position:absolute; top:0; right:0; bottom:0; width:40%; background:radial-gradient(ellipse at right, rgba(0,212,255,0.03), transparent); pointer-events:none; }
.stat-card:hover { border-color:var(--border-accent); box-shadow:0 0 20px rgba(0,212,255,0.1); transform:translateY(-1px); }
.stat-label { font-size:10px; color:var(--text-muted); text-transform:uppercase; letter-spacing:1.5px; margin-bottom:8px; font-family:var(--mono); }
.stat-value { font-size:28px; font-weight:700; font-family:var(--mono); color:var(--accent); text-shadow:0 0 20px rgba(0,212,255,0.4), 0 0 40px rgba(0,212,255,0.15); }
.stat-sub { font-size:11px; color:var(--text-secondary); margin-top:4px; font-family:var(--mono); }

/* Form */
.form-group { margin-bottom:16px; }
.form-group label { display:block; font-size:11px; font-weight:600; color:var(--text-muted); margin-bottom:6px; text-transform:uppercase; letter-spacing:1px; }
.form-group .hint { font-size:11px; color:var(--text-muted); margin-top:3px; }
input[type="text"],input[type="number"],input:not([type]),select,textarea { width:100%; padding:9px 12px; background:var(--bg-input); border:1px solid rgba(0,212,255,0.1); border-radius:var(--radius-sm); color:var(--text-primary); font-family:var(--font); font-size:13px; outline:none; transition:all var(--fast); }
input:focus,select:focus,textarea:focus { border-color:var(--accent); box-shadow:0 0 12px rgba(0,212,255,0.1); }
select { cursor:pointer; }
textarea { resize:vertical; min-height:70px; font-family:var(--mono); font-size:12px; }

/* Range */
.range-group { display:flex; align-items:center; gap:14px; }
.range-group input[type="range"] { flex:1; -webkit-appearance:none; height:3px; background:rgba(0,212,255,0.15); border-radius:2px; border:none; outline:none; }
.range-group input[type="range"]::-webkit-slider-thumb { -webkit-appearance:none; width:16px; height:16px; border-radius:50%; background:var(--accent); cursor:pointer; box-shadow:0 0 15px rgba(0,212,255,0.6), 0 0 30px rgba(0,212,255,0.2); border:2px solid rgba(0,212,255,0.8); }
.range-value { min-width:40px; text-align:center; font-family:var(--mono); font-size:14px; font-weight:700; color:var(--accent); text-shadow:0 0 15px rgba(0,212,255,0.4); }

/* Toggle */
.toggle-group { display:flex; align-items:center; justify-content:space-between; }
.toggle { position:relative; width:42px; height:22px; cursor:pointer; }
.toggle input { display:none; }
.toggle-track { position:absolute; inset:0; background:var(--bg-input); border:1px solid rgba(0,212,255,0.15); border-radius:11px; transition:all var(--fast); }
.toggle input:checked + .toggle-track { background:rgba(0,212,255,0.08); border-color:var(--accent); box-shadow:0 0 15px rgba(0,212,255,0.2), inset 0 0 8px rgba(0,212,255,0.1); }
.toggle-thumb { position:absolute; top:3px; left:3px; width:16px; height:16px; border-radius:50%; background:var(--text-muted); transition:all var(--fast); }
.toggle input:checked ~ .toggle-thumb { left:23px; background:var(--accent); box-shadow:0 0 12px rgba(0,212,255,0.5), 0 0 25px rgba(0,212,255,0.2); }

/* Buttons */
.btn { display:inline-flex; align-items:center; gap:8px; padding:9px 18px; border:none; border-radius:var(--radius-sm); font-family:var(--font); font-size:12px; font-weight:600; cursor:pointer; transition:all var(--fast); text-transform:uppercase; letter-spacing:1px; }
.btn-primary { background:rgba(0,212,255,0.08); color:var(--accent); border:1px solid var(--accent); box-shadow:0 0 15px rgba(0,212,255,0.15), inset 0 0 15px rgba(0,212,255,0.05); }
.btn-primary:hover { background:rgba(0,212,255,0.15); box-shadow:0 0 25px rgba(0,212,255,0.3), inset 0 0 20px rgba(0,212,255,0.08); }
.btn-secondary { background:transparent; color:var(--text-primary); border:1px solid var(--border-accent); }
.btn-secondary:hover { border-color:var(--accent); background:rgba(0,212,255,0.05); box-shadow:0 0 10px rgba(0,212,255,0.1); }
.btn-danger { background:transparent; color:var(--danger); border:1px solid rgba(239,68,68,0.3); }
.btn-danger:hover { border-color:var(--danger); background:var(--danger-dim); }
.btn-sm { padding:5px 12px; font-size:11px; }
.auto-save-status { font-size:12px; color:var(--text-muted); transition:opacity 0.3s; min-width:120px; text-align:right; }
.auto-save-status.saving { color:var(--accent); }
.auto-save-status.saved { color:var(--success, #22c55e); }
.auto-save-status.error { color:var(--danger); }

/* Tab Bar */
.tab-bar { display:flex; gap:2px; background:rgba(21,29,48,0.5); padding:3px; border-radius:var(--radius-sm); margin-bottom:20px; flex-wrap:wrap; border:1px solid rgba(0,212,255,0.08); }
.tab-item { padding:7px 14px; border-radius:6px; font-size:11px; font-weight:500; color:var(--text-secondary); cursor:pointer; transition:all var(--fast); white-space:nowrap; text-transform:uppercase; letter-spacing:0.5px; }
.tab-item:hover { color:var(--text-primary); background:rgba(0,212,255,0.05); }
.tab-item.active { background:rgba(0,212,255,0.1); color:var(--accent); box-shadow:0 0 10px rgba(0,212,255,0.1); border:1px solid rgba(0,212,255,0.2); }

/* Settings Section (collapsible) */
.s-section { border:1px solid rgba(0,212,255,0.1); border-radius:var(--radius-md); margin-bottom:14px; overflow:visible; }
.s-section-hdr { display:flex; align-items:center; justify-content:space-between; padding:14px 18px; background:var(--bg-card); cursor:pointer; transition:all var(--fast); border-left:2px solid transparent; border-radius:var(--radius-md) var(--radius-md) 0 0; }
.s-section-hdr:hover { background:var(--bg-card-hover); border-left-color:var(--accent); }
.s-section-hdr h3 { font-size:13px; font-weight:600; display:flex; align-items:center; gap:8px; text-transform:uppercase; letter-spacing:0.5px; }
.s-section-hdr .arrow { transition:transform var(--fast); color:var(--accent); font-size:12px; }
.s-section-hdr.open .arrow { transform:rotate(180deg); }
.s-section-hdr.open { border-left-color:var(--accent); }
.s-section-body { padding:0 18px; max-height:0; overflow:hidden; transition:max-height 0.3s ease,padding 0.3s ease,overflow 0s 0.3s; }
.s-section-body.open { padding:18px; max-height:5000px; overflow:visible; transition:max-height 0.3s ease,padding 0.3s ease,overflow 0s 0s; }

/* Entity */
.entity-picker { background:var(--bg-card); border:1px solid rgba(0,212,255,0.1); border-radius:var(--radius-md); padding:14px; margin-bottom:14px; }
.entity-search { padding:8px 12px; background:var(--bg-input); border:1px solid rgba(0,212,255,0.1); border-radius:var(--radius-sm); color:var(--text-primary); font-size:13px; width:100%; margin-bottom:10px; outline:none; font-family:var(--mono); transition:all var(--fast); }
.entity-search:focus { border-color:var(--accent); box-shadow:0 0 12px rgba(0,212,255,0.1); }
.entity-list { max-height:400px; overflow-y:auto; border:1px solid rgba(0,212,255,0.08); border-radius:var(--radius-sm); }
.entity-item { display:flex; align-items:center; gap:10px; padding:8px 12px; cursor:pointer; font-size:12px; border-bottom:1px solid rgba(0,212,255,0.05); transition:all var(--fast); }
.entity-item:last-child { border-bottom:none; }
.entity-item:hover { background:rgba(0,212,255,0.03); border-left:2px solid var(--accent); }
.entity-item .eid { color:var(--text-muted); font-family:var(--mono); font-size:10px; }
.entity-item .ename { flex:1; font-family:var(--mono); font-size:12px; }
.selected-entities { display:flex; flex-wrap:wrap; gap:5px; margin-top:6px; }
.entity-tag { display:inline-flex; align-items:center; gap:5px; padding:3px 9px; background:var(--accent-dim); border:1px solid var(--border-accent); border-radius:16px; font-size:11px; color:var(--accent); font-family:var(--mono); }
.entity-tag .remove { cursor:pointer; opacity:0.6; font-size:13px; }
.entity-tag .remove:hover { opacity:1; }

/* Logs */
.log-entry { display:flex; gap:14px; padding:10px 14px; border-bottom:1px solid rgba(0,212,255,0.06); font-size:12px; transition:background var(--fast); }
.log-entry:hover { background:rgba(0,212,255,0.03); }
.log-time { color:var(--text-muted); font-family:var(--mono); font-size:11px; min-width:70px; }
.log-role { min-width:55px; font-weight:700; font-size:10px; text-transform:uppercase; letter-spacing:1px; font-family:var(--mono); }
.log-role.user { color:var(--blue); }
.log-role.assistant { color:var(--accent); }
.log-content { flex:1; color:var(--text-primary); line-height:1.5; }

/* Fehlerspeicher */
.err-entry { display:flex; gap:14px; padding:10px 14px; border-bottom:1px solid rgba(0,212,255,0.06); font-size:12px; align-items:flex-start; transition:background var(--fast); }
.err-entry:hover { background:rgba(0,212,255,0.03); }
.err-entry.level-ERROR { border-left:3px solid var(--danger); box-shadow:inset 4px 0 12px rgba(239,68,68,0.05); }
.err-entry.level-WARNING { border-left:3px solid var(--accent); box-shadow:inset 4px 0 12px rgba(0,212,255,0.05); }
.err-time { color:var(--text-muted); font-family:var(--mono); font-size:11px; min-width:130px; white-space:nowrap; }
.err-level { min-width:60px; font-weight:700; font-size:11px; text-transform:uppercase; font-family:var(--mono); }
.err-level.ERROR { color:var(--danger); }
.err-level.WARNING { color:var(--accent); }
.err-logger { min-width:120px; color:var(--text-muted); font-family:var(--mono); font-size:11px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.err-msg { flex:1; color:var(--text-primary); line-height:1.5; word-break:break-word; }
.err-badge { display:inline-flex; align-items:center; justify-content:center; min-width:18px; height:18px; padding:0 5px; border-radius:9px; background:var(--danger); color:white; font-size:10px; font-weight:700; margin-left:6px; }
.err-filter-bar { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.err-filter-bar .btn { font-size:10px; padding:4px 12px; border:1px solid rgba(0,212,255,0.12); }
.err-filter-bar .btn.active-filter { background:var(--accent-dim); color:var(--accent); border-color:var(--accent); box-shadow:0 0 8px rgba(0,212,255,0.15); }

/* Audit Log */
.audit-entry { display:flex; gap:14px; padding:10px 14px; border-bottom:1px solid rgba(0,212,255,0.06); font-size:12px; align-items:flex-start; transition:background var(--fast); }
.audit-entry:hover { background:rgba(0,212,255,0.03); }
.audit-time { color:var(--text-muted); font-family:var(--mono); font-size:10px; min-width:130px; white-space:nowrap; }
.audit-action { min-width:120px; font-weight:700; font-size:10px; font-family:var(--mono); padding:2px 8px; border-radius:4px; text-align:center; text-transform:uppercase; letter-spacing:0.5px; }
.audit-action.auth { background:var(--blue-dim); color:var(--blue); }
.audit-action.settings { background:var(--accent-dim); color:var(--accent); }
.audit-action.security { background:var(--danger-dim); color:var(--danger); }
.audit-action.system { background:var(--success-dim); color:var(--success); }
.audit-details { flex:1; color:var(--text-secondary); font-size:11px; word-break:break-word; }

/* Live-Status Indicator */
.live-dot { width:8px; height:8px; border-radius:50%; background:var(--success); display:inline-block; animation:livePulse 2s infinite; box-shadow:0 0 8px rgba(0,230,118,0.5), 0 0 20px rgba(0,230,118,0.2); }
.live-dot.offline { background:var(--danger); animation:none; box-shadow:0 0 8px rgba(255,61,61,0.5), 0 0 20px rgba(255,61,61,0.2); }
@keyframes livePulse { 0%,100%{opacity:1;box-shadow:0 0 8px rgba(16,185,129,0.5);} 50%{opacity:0.4;box-shadow:0 0 4px rgba(16,185,129,0.2);} }

/* Health Trends */
.trend-card { padding:14px; }
.trend-row { display:flex; align-items:center; gap:12px; padding:10px 0; border-bottom:1px solid rgba(0,212,255,0.06); }
.trend-row:last-child { border-bottom:none; }
.trend-label { min-width:100px; font-size:11px; color:var(--text-muted); text-transform:uppercase; letter-spacing:1px; font-family:var(--mono); }
.trend-value { font-size:18px; font-weight:700; font-family:var(--mono); min-width:70px; color:var(--accent); }
.trend-unit { font-size:10px; color:var(--text-muted); font-family:var(--mono); }
.trend-arrow { font-size:14px; }
.trend-arrow.up { color:var(--danger); text-shadow:0 0 8px rgba(239,68,68,0.3); }
.trend-arrow.down { color:var(--blue); text-shadow:0 0 8px rgba(59,130,246,0.3); }
.trend-arrow.stable { color:var(--success); text-shadow:0 0 8px rgba(16,185,129,0.3); }
.trend-sparkline { flex:1; height:24px; }
.trend-period-bar { display:flex; gap:6px; margin-bottom:12px; }
.trend-period-bar button { font-size:10px; padding:3px 10px; border:1px solid rgba(0,212,255,0.15); border-radius:4px; background:transparent; color:var(--text-muted); cursor:pointer; font-family:var(--mono); text-transform:uppercase; transition:all var(--fast); }
.trend-period-bar button:hover { border-color:var(--border-accent); color:var(--text-primary); }
.trend-period-bar button.active { background:var(--accent-dim); color:var(--accent); border-color:var(--accent); box-shadow:0 0 8px rgba(0,212,255,0.15); }

/* Section Header */
.section-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:20px; }
.section-header h2 { font-size:16px; font-weight:600; text-transform:uppercase; letter-spacing:3px; color:var(--accent); }
.section-header p { font-size:11px; color:var(--text-muted); margin-top:3px; text-transform:uppercase; letter-spacing:1px; font-family:var(--mono); }

/* Knowledge Files */
.file-item { display:flex; align-items:center; gap:12px; padding:10px 14px; border-bottom:1px solid var(--border); font-size:12px; }
.file-name { flex:1; font-weight:500; }
.file-size { color:var(--text-muted); font-family:var(--mono); font-size:11px; }

/* Badge */
.badge { padding:3px 10px; border-radius:16px; font-size:10px; font-weight:600; text-transform:uppercase; letter-spacing:1px; font-family:var(--mono); }
.badge-ok { background:var(--success-dim); color:var(--success); border:1px solid rgba(16,185,129,0.3); }
.badge-warn { background:rgba(0,212,255,0.15); color:var(--accent); border:1px solid rgba(0,212,255,0.3); }
.badge-err { background:var(--danger-dim); color:var(--danger); border:1px solid rgba(239,68,68,0.3); }

/* Mobile */
.mobile-toggle { display:none; align-items:center; justify-content:center; width:40px; height:40px; border-radius:var(--radius-sm); background:transparent; border:1px solid var(--border-accent); cursor:pointer; font-size:18px; color:var(--accent); transition:all var(--fast); -webkit-tap-highlight-color:transparent; }
.mobile-toggle:hover { box-shadow:0 0 15px rgba(0,212,255,0.3), inset 0 0 10px rgba(0,212,255,0.05); }

/* Sidebar Backdrop (mobile overlay) */
.sidebar-backdrop { display:none; position:fixed; inset:0; background:rgba(10,14,23,0.7); z-index:99; backdrop-filter:blur(4px); -webkit-tap-highlight-color:transparent; }
.sidebar-backdrop.show { display:block; }

/* Toast */
.toast { position:fixed; bottom:20px; right:20px; padding:12px 22px; border-radius:var(--radius-sm); font-size:12px; font-weight:600; box-shadow:var(--shadow-lg); z-index:9999; transform:translateY(80px); opacity:0; transition:all 0.3s ease; text-transform:uppercase; letter-spacing:1px; font-family:var(--mono); backdrop-filter:blur(8px); }
.toast.show { transform:translateY(0); opacity:1; }
.toast-success { background:rgba(16,185,129,0.9); color:white; border:1px solid rgba(16,185,129,0.6); box-shadow:0 0 20px rgba(16,185,129,0.3); }
.toast-error { background:rgba(239,68,68,0.9); color:white; border:1px solid rgba(239,68,68,0.6); box-shadow:0 0 20px rgba(239,68,68,0.3); }
.toast-info { background:rgba(59,130,246,0.9); color:white; border:1px solid rgba(59,130,246,0.6); box-shadow:0 0 20px rgba(59,130,246,0.3); }

/* Scrollbar */
::-webkit-scrollbar { width:4px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:rgba(0,212,255,0.2); border-radius:2px; }
::-webkit-scrollbar-thumb:hover { background:rgba(0,212,255,0.4); }

/* Loading */
.spinner { width:28px; height:28px; border:2px solid rgba(0,212,255,0.15); border-top-color:var(--accent); border-radius:50%; animation:spin 0.8s linear infinite; display:inline-block; margin-right:10px; box-shadow:0 0 10px rgba(0,212,255,0.1); }
@keyframes spin { to { transform:rotate(360deg); } }

/* Utility Classes (inline-style Ersatz) */
.flex { display:flex; }
.flex-center { display:flex; align-items:center; }
.flex-between { display:flex; align-items:center; justify-content:space-between; }
.gap-sm { gap:8px; }
.gap-md { gap:10px; }
.mt-md { margin-top:16px; }
.mb-md { margin-bottom:14px; }
.mb-0 { margin-bottom:0; }
.text-xs { font-size:10px; }
.text-sm { font-size:11px; }
.text-muted-sm { font-size:11px; color:var(--text-muted); }
.no-pad { padding:0; }

/* ---- Sidebar Nav Groups (collapsible) ---- */
.nav-group { margin-bottom:4px; }
.nav-group-header { display:flex; align-items:center; gap:8px; padding:8px 14px; color:var(--text-muted); cursor:pointer; font-size:10px; font-weight:700; text-transform:uppercase; letter-spacing:1.5px; transition:all var(--fast); user-select:none; border-radius:var(--radius-sm); }
.nav-group-header:hover { color:var(--text-secondary); background:rgba(0,212,255,0.02); }
.nav-group-header .nav-group-arrow { font-size:8px; color:var(--text-muted); transition:transform var(--fast); margin-left:auto; }
.nav-group-header.open .nav-group-arrow { transform:rotate(90deg); }
.nav-group-header.open { color:var(--accent); }
.nav-group-items { max-height:0; overflow:hidden; transition:max-height 0.25s ease; }
.nav-group-items.open { max-height:500px; }
.nav-group-items .nav-item { padding:7px 14px 7px 32px; font-size:11px; min-height:34px; }
.nav-divider { height:1px; background:rgba(0,212,255,0.06); margin:6px 12px; }

/* ---- Help Tooltip Button ---- */
.help-btn { display:inline-flex; align-items:center; justify-content:center; width:16px; height:16px; border-radius:50%; background:rgba(0,212,255,0.08); border:1px solid rgba(0,212,255,0.2); color:var(--accent); font-size:9px; font-weight:700; cursor:pointer; margin-left:6px; transition:all var(--fast); flex-shrink:0; line-height:1; font-family:var(--mono); vertical-align:middle; }
.help-btn:hover { background:rgba(0,212,255,0.2); border-color:var(--accent); box-shadow:0 0 10px rgba(0,212,255,0.3); transform:scale(1.15); }

/* ---- Help Modal ---- */
.help-modal-backdrop { display:none; position:fixed; inset:0; background:rgba(4,8,16,0.8); z-index:9998; backdrop-filter:blur(4px); }
.help-modal-backdrop.show { display:flex; align-items:center; justify-content:center; }
.help-modal { background:linear-gradient(135deg, rgba(12,21,32,0.98), rgba(8,16,24,0.99)); border:1px solid rgba(0,212,255,0.25); border-radius:var(--radius-lg); padding:28px; max-width:460px; width:calc(100vw - 32px); max-height:80vh; overflow-y:auto; position:relative; box-shadow:0 0 40px rgba(0,212,255,0.15), 0 8px 32px rgba(0,0,0,0.6); }
.help-modal::before { content:''; position:absolute; top:-1px; left:-1px; width:16px; height:16px; border-top:1px solid rgba(0,212,255,0.5); border-left:1px solid rgba(0,212,255,0.5); pointer-events:none; }
.help-modal::after { content:''; position:absolute; bottom:-1px; right:-1px; width:16px; height:16px; border-bottom:1px solid rgba(0,212,255,0.5); border-right:1px solid rgba(0,212,255,0.5); pointer-events:none; }
.help-modal-close { position:absolute; top:12px; right:14px; background:none; border:1px solid rgba(0,212,255,0.15); border-radius:var(--radius-sm); color:var(--text-muted); font-size:16px; cursor:pointer; width:28px; height:28px; display:flex; align-items:center; justify-content:center; transition:all var(--fast); }
.help-modal-close:hover { color:var(--accent); border-color:var(--accent); background:rgba(0,212,255,0.08); }
.help-modal h3 { font-size:14px; font-weight:700; color:var(--accent); text-transform:uppercase; letter-spacing:1px; margin-bottom:14px; padding-right:36px; text-shadow:0 0 12px rgba(0,212,255,0.3); }
.help-modal p { font-size:13px; color:var(--text-primary); line-height:1.7; margin-bottom:10px; }
.help-modal .help-detail { font-size:12px; color:var(--text-secondary); line-height:1.6; padding:10px 14px; background:rgba(0,212,255,0.03); border:1px solid rgba(0,212,255,0.08); border-radius:var(--radius-sm); margin-top:10px; }
.help-modal .help-values { font-family:var(--mono); font-size:11px; color:var(--accent); margin-top:4px; }
.help-modal .help-warn { color:var(--danger); font-size:12px; margin-top:8px; font-weight:600; }

/* Settings Tab-Bar Gruppen-Divider */
.tab-bar .tab-divider { width:1px; background:rgba(0,212,255,0.12); margin:4px 4px; align-self:stretch; }

/* Dashboard Live Indicator */
.dash-live-bar { display:flex; align-items:center; gap:8px; margin-bottom:14px; }
.whisper-badge { display:none; font-size:10px; padding:2px 8px; background:var(--blue-dim); color:var(--blue); border-radius:10px; font-weight:600; }

/* Entity Browser verbessert */
.entity-list-card { padding:0; }
.entity-list-card .entity-list { max-height:500px; }
.entity-filter-bar { display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:14px; }

/* Keyword tags editor */
.kw-editor { display:flex; flex-wrap:wrap; gap:4px; padding:8px; background:var(--bg-input); border:1px solid var(--border); border-radius:var(--radius-sm); min-height:36px; cursor:text; }
.kw-tag { display:inline-flex; align-items:center; gap:4px; padding:2px 8px; background:var(--accent-dim); border:1px solid var(--border-accent); border-radius:12px; font-size:11px; color:var(--accent); font-family:var(--mono); }
.kw-tag .kw-rm { cursor:pointer; opacity:0.6; }
.kw-tag .kw-rm:hover { opacity:1; }
.kw-input { border:none; background:transparent; color:var(--text-primary); font-family:var(--font); font-size:12px; outline:none; min-width:80px; flex:1; }
/* Key-Value Editor (Device-Mapping, DoA-Mapping) */
.kv-editor { display:flex; flex-direction:column; gap:6px; }
.kv-row { display:flex; align-items:center; gap:6px; min-width:0; }
.kv-row input { flex:1; padding:6px 8px; background:var(--bg-input); border:1px solid var(--border); border-radius:var(--radius-sm); color:var(--text-primary); font-family:var(--mono); font-size:11px; min-width:0; }
.kv-row input:focus { border-color:var(--accent); outline:none; }
.kv-arrow { color:var(--text-muted); font-size:14px; flex-shrink:0; }
.kv-rm { background:none; border:none; color:var(--danger); cursor:pointer; font-size:14px; padding:2px 6px; opacity:0.6; flex-shrink:0; }
.kv-rm:hover { opacity:1; }
.kv-add { background:var(--accent-dim); border:1px dashed var(--border-accent); border-radius:var(--radius-sm); color:var(--accent); cursor:pointer; padding:6px 12px; font-size:11px; font-family:var(--font); }
.kv-add:hover { background:var(--accent); color:var(--bg); }
.entity-pick-wrap { position:relative; }
.entity-pick-dropdown { position:absolute; top:100%; left:0; right:0; max-height:200px; overflow-y:auto; background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius-sm); box-shadow:0 4px 12px rgba(0,0,0,0.3); z-index:100; }
.entity-pick-item { padding:6px 10px; cursor:pointer; display:flex; justify-content:space-between; align-items:center; gap:8px; font-size:12px; border-bottom:1px solid var(--border); }
.entity-pick-item:hover { background:var(--bg-card-hover); }
.entity-pick-item .ename { color:var(--text-primary); font-weight:500; }
.entity-pick-item .eid { color:var(--text-muted); font-family:var(--mono); font-size:10px; }

/* Chip Select — klickbare vordefinierte Optionen */
.chip-grid { display:flex; flex-wrap:wrap; gap:6px; padding:8px 0; }
.chip-opt { display:inline-flex; align-items:center; gap:4px; padding:5px 12px; background:transparent; border:1px solid rgba(0,212,255,0.12); border-radius:16px; font-size:11px; color:var(--text-secondary); cursor:pointer; transition:all var(--fast); user-select:none; text-transform:uppercase; letter-spacing:0.5px; }
.chip-opt:hover { border-color:var(--border-accent); color:var(--text-primary); background:rgba(0,212,255,0.05); }
.chip-opt.selected { background:var(--accent-dim); border-color:var(--accent); color:var(--accent); font-weight:600; box-shadow:0 0 10px rgba(0,212,255,0.15); }
.chip-opt.selected::before { content:'✓ '; font-size:10px; }

/* Info-Hint Box */
.info-box { display:flex; align-items:flex-start; gap:8px; padding:10px 14px; background:var(--blue-dim); border:1px solid rgba(59,130,246,0.2); border-radius:var(--radius-sm); margin-bottom:14px; font-size:12px; color:var(--text-secondary); line-height:1.5; }
.info-box .info-icon { font-size:14px; flex-shrink:0; margin-top:1px; }

/* ---- J.A.R.V.I.S. Boot Sequence ---- */
.boot-screen { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: var(--bg-primary); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
.boot-screen::before { content:''; position:absolute; inset:0; background:radial-gradient(circle at center, rgba(0,212,255,0.04) 0%, transparent 60%); }
.boot-hud { position: relative; width: 280px; height: 280px; margin-bottom: 40px; }
.boot-circle { position:absolute; inset:0; animation: bootRotate 3s linear infinite; }
.boot-ring { fill: none; stroke: rgba(0,212,255,0.08); stroke-width: 1.5; }
.boot-ring-fill { fill: none; stroke: var(--accent); stroke-width: 2; stroke-dasharray: 565; stroke-dashoffset: 565; stroke-linecap: round; animation: bootDraw 2s ease-out forwards; filter: drop-shadow(0 0 10px rgba(0,212,255,0.7)); }
.boot-ring-outer { position:absolute; inset:0; animation: bootRotateReverse 6s linear infinite; }
.boot-ring-inner { position:absolute; inset:0; animation: bootRotate 10s linear infinite; }
.boot-logo { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 32px; font-weight: 700; color: var(--accent); opacity: 0; animation: bootFadeIn 0.6s ease 0.3s forwards; text-shadow: 0 0 40px rgba(0,212,255,0.7), 0 0 80px rgba(0,212,255,0.3), 0 0 120px rgba(0,212,255,0.1); letter-spacing: 8px; white-space:nowrap; }
.boot-text { font-family: var(--mono); font-size: 13px; color: var(--accent); letter-spacing: 3px; min-height: 20px; text-transform: uppercase; text-shadow: 0 0 15px rgba(0,212,255,0.4); }
.boot-systems { display: flex; gap: 12px; margin-top: 24px; }
.boot-sys { display: flex; align-items: center; gap: 6px; font-size: 11px; color: var(--text-muted); opacity: 0; animation: bootFadeIn 0.3s ease forwards; }
.boot-sys .sys-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--text-muted); transition: background 0.3s, box-shadow 0.3s; }
.boot-sys.online .sys-dot { background: var(--success); box-shadow: 0 0 8px rgba(0,230,118,0.5); }
.boot-sys.online { color: var(--text-secondary); }
.boot-screen.fade-out { animation: bootFadeOut 0.5s ease forwards; }
@keyframes bootDraw { to { stroke-dashoffset: 0; } }
@keyframes bootRotate { to { transform: rotate(360deg); } }
@keyframes bootRotateReverse { to { transform: rotate(-360deg); } }
@keyframes bootFadeIn { to { opacity: 1; } }
@keyframes bootFadeOut { to { opacity: 0; pointer-events: none; } }

/* ---- J.A.R.V.I.S. HUD System ---- */

/* Arc reactor ambient glow on dashboard */
#page-dashboard { position:relative; }
#page-dashboard::before { content:''; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); width:600px; height:600px; border-radius:50%; background:radial-gradient(circle, rgba(0,212,255,0.03) 0%, rgba(0,212,255,0.01) 30%, transparent 70%); pointer-events:none; z-index:0; animation:reactorPulse 4s ease-in-out infinite; }
@keyframes reactorPulse { 0%,100% { opacity:0.6; transform:translate(-50%,-50%) scale(1); } 50% { opacity:1; transform:translate(-50%,-50%) scale(1.05); } }

/* Holographic grid overlay */
.main-content { position:relative; }
.main-content::before { content:''; position:fixed; top:0; left:var(--sidebar-w); right:0; bottom:0; background-image:
  linear-gradient(rgba(0,212,255,0.012) 1px, transparent 1px),
  linear-gradient(90deg, rgba(0,212,255,0.012) 1px, transparent 1px);
  background-size: 40px 40px; pointer-events:none; z-index:0; animation: gridFlicker 8s ease-in-out infinite; }
@keyframes gridFlicker { 0%,100% { opacity:1; } 50% { opacity:0.6; } }

/* Dual scan lines */
.main::after { content:''; position:fixed; left:var(--sidebar-w); right:0; height:1px; background:linear-gradient(90deg, transparent 5%, rgba(0,212,255,0.2) 20%, rgba(0,212,255,0.4) 50%, rgba(0,212,255,0.2) 80%, transparent 95%); animation:mainScan 8s ease-in-out infinite; pointer-events:none; z-index:1; filter: drop-shadow(0 0 8px rgba(0,212,255,0.4)); }
@keyframes mainScan { 0%,100% { top:5%; opacity:0.4; } 50% { top:95%; opacity:0.15; } }

/* Cards — holographic panels */
.card { position:relative; border-color:rgba(0,212,255,0.08); background:linear-gradient(135deg, rgba(12,21,32,0.95), rgba(8,16,24,0.98)); backdrop-filter:blur(4px); }
.card::before { content:''; position:absolute; top:0; left:0; right:0; height:1px; background:linear-gradient(90deg, transparent, rgba(0,212,255,0.35), transparent); border-radius:var(--radius-md) var(--radius-md) 0 0; }
.card::after { content:''; position:absolute; inset:-1px; border-radius:var(--radius-md); opacity:0; transition:opacity 0.4s ease; pointer-events:none; box-shadow: 0 0 20px rgba(0,212,255,0.06), inset 0 0 30px rgba(0,212,255,0.02); }
.card:hover { border-color:rgba(0,212,255,0.2); }
.card:hover::after { opacity:1; }

/* Stat card — energy readout style */
.stat-card { background:linear-gradient(135deg, rgba(12,21,32,0.95), rgba(8,16,24,0.98)); border-color:rgba(0,212,255,0.08); backdrop-filter:blur(4px); }
.stat-card::before { content:''; position:absolute; top:0; left:0; width:2px; height:100%; background:linear-gradient(180deg, var(--accent), rgba(0,212,255,0.3), transparent); border-radius:var(--radius-md) 0 0 var(--radius-md); box-shadow: 0 0 12px rgba(0,212,255,0.4); animation: statBarPulse 3s ease-in-out infinite; }
@keyframes statBarPulse { 0%,100% { box-shadow: 0 0 8px rgba(0,212,255,0.3); } 50% { box-shadow: 0 0 16px rgba(0,212,255,0.6); } }
.stat-card::after { content:''; position:absolute; top:0; right:0; bottom:0; width:50%; background:radial-gradient(ellipse at right, rgba(0,212,255,0.02), transparent); pointer-events:none; }

/* Section panels — HUD brackets + animated borders */
.s-section { position:relative; border-color:rgba(0,212,255,0.06); background:rgba(8,16,24,0.5); }
.s-section::before { content:''; position:absolute; top:-1px; left:-1px; width:16px; height:16px; border-top:1px solid rgba(0,212,255,0.4); border-left:1px solid rgba(0,212,255,0.4); pointer-events:none; z-index:2; }
.s-section::after { content:''; position:absolute; bottom:-1px; right:-1px; width:16px; height:16px; border-bottom:1px solid rgba(0,212,255,0.4); border-right:1px solid rgba(0,212,255,0.4); pointer-events:none; z-index:2; }
.s-section-hdr { background:linear-gradient(135deg, rgba(12,21,32,0.9), rgba(8,16,24,0.95)); border-bottom:1px solid rgba(0,212,255,0.06); }
.s-section-hdr h3 { position:relative; }
.s-section-hdr.open h3 { color:var(--accent); text-shadow: 0 0 12px rgba(0,212,255,0.4); }
.s-section-hdr.open { border-left-color:var(--accent); box-shadow: inset 2px 0 10px rgba(0,212,255,0.05); }

/* Tab bar — HUD selector */
.tab-bar { background:rgba(8,16,24,0.6); border:1px solid rgba(0,212,255,0.06); }
.tab-item.active { position:relative; background:rgba(0,212,255,0.08); border:1px solid rgba(0,212,255,0.2); text-shadow: 0 0 10px rgba(0,212,255,0.3); }
.tab-item.active::after { content:''; position:absolute; bottom:-2px; left:15%; right:15%; height:1px; background:var(--accent); box-shadow: 0 0 8px var(--accent), 0 0 20px rgba(0,212,255,0.3); }

/* Inputs — holographic fields */
input[type="text"],input[type="number"],input:not([type]),select,textarea { background:rgba(0,212,255,0.02); border-color:rgba(0,212,255,0.08); }
input:focus,select:focus,textarea:focus { border-color:var(--accent); box-shadow:0 0 20px rgba(0,212,255,0.12), inset 0 0 15px rgba(0,212,255,0.03); }

/* Toggle — reactor switch */
.toggle-track { background:rgba(0,212,255,0.03); border-color:rgba(0,212,255,0.12); }

/* Range slider — energy bar */
.range-group input[type="range"] { background:rgba(0,212,255,0.08); }

/* Live dot — system heartbeat */
.live-dot { box-shadow:0 0 8px rgba(0,230,118,0.6), 0 0 25px rgba(0,230,118,0.2); }
@keyframes livePulse { 0%,100%{opacity:1;box-shadow:0 0 10px rgba(0,230,118,0.6), 0 0 25px rgba(0,230,118,0.2);} 50%{opacity:0.4;box-shadow:0 0 4px rgba(0,230,118,0.3);} }

/* Scrollbar */
::-webkit-scrollbar-thumb { background:rgba(0,212,255,0.12); }
::-webkit-scrollbar-thumb:hover { background:rgba(0,212,255,0.25); }

/* Section header */
.section-header h2 { text-shadow: 0 0 25px rgba(0,212,255,0.35); letter-spacing:3px; }

/* Toast — system notification */
.toast { border:1px solid rgba(0,212,255,0.2); }
.toast-success { box-shadow:0 0 30px rgba(0,230,118,0.25); }
.toast-error { box-shadow:0 0 30px rgba(255,61,61,0.25); }
.toast-info { box-shadow:0 0 30px rgba(0,212,255,0.25); }

/* Badge */
.badge-ok { box-shadow: 0 0 12px rgba(0,230,118,0.2); }
.badge-warn { box-shadow: 0 0 12px rgba(0,212,255,0.2); }
.badge-err { box-shadow: 0 0 12px rgba(255,61,61,0.2); }

/* Nav items — holographic buttons */
.nav-item { position:relative; overflow:hidden; }
.nav-item::after { content:''; position:absolute; top:0; left:-100%; width:100%; height:100%; background:linear-gradient(90deg, transparent, rgba(0,212,255,0.06), transparent); transition:left 0.6s ease; pointer-events:none; }
.nav-item:hover::after { left:100%; }
.nav-item.active { box-shadow: inset 0 0 15px rgba(0,212,255,0.04); }

/* Chips & Tags */
.chip-opt.selected { text-shadow: 0 0 10px rgba(0,212,255,0.3); box-shadow: 0 0 10px rgba(0,212,255,0.1); }
.kw-tag { box-shadow: 0 0 8px rgba(0,212,255,0.08); }
.entity-tag { box-shadow: 0 0 8px rgba(0,212,255,0.08); }

/* Info box — system advisory */
.info-box { background:rgba(0,212,255,0.04); border-color:rgba(0,212,255,0.12); }

/* Spinner — loading */
.spinner { border-color:rgba(0,212,255,0.1); border-top-color:var(--accent); box-shadow:0 0 15px rgba(0,212,255,0.15); }

/* Sidebar — command panel */
.sidebar { background:linear-gradient(180deg, rgba(8,14,24,0.98), rgba(6,10,18,0.99)); }

/* Header — tactical bar */
.main-header { background:linear-gradient(90deg, rgba(8,14,24,0.97), rgba(10,16,28,0.95), rgba(8,14,24,0.97)); }

/* Entity picker dropdown */
.entity-pick-dropdown { background:rgba(12,21,32,0.98); border-color:rgba(0,212,255,0.15); box-shadow:0 4px 20px rgba(0,0,0,0.5), 0 0 15px rgba(0,212,255,0.05); }

/* Keyword editor */
.kw-editor { background:rgba(0,212,255,0.02); border-color:rgba(0,212,255,0.08); }

/* Log entries — data stream */
.log-entry:hover { background:rgba(0,212,255,0.02); }
.err-entry:hover { background:rgba(0,212,255,0.02); }
.audit-entry:hover { background:rgba(0,212,255,0.02); }

/* Trend value glow */
.trend-value { text-shadow: 0 0 12px rgba(0,212,255,0.3); }

/* ---- Arc Reactor Dashboard Background ---- */
.arc-reactor-bg { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); width:500px; height:500px; opacity:0.5; pointer-events:none; z-index:0; }
.arc-ring-1 { animation: arcSpin1 20s linear infinite; transform-origin:200px 200px; }
.arc-ring-2 { animation: arcSpin2 15s linear infinite; transform-origin:200px 200px; }
.arc-ring-3 { animation: arcSpin3 25s linear infinite; transform-origin:200px 200px; }
@keyframes arcSpin1 { to { transform:rotate(360deg); } }
@keyframes arcSpin2 { to { transform:rotate(-360deg); } }
@keyframes arcSpin3 { to { transform:rotate(360deg); } }

/* Login — enhanced arc reactor HUD */
.login-hud-ring { width:140px; height:140px; top:-70px; }
.login-box::before { content:''; position:absolute; inset:-1px; border-radius:var(--radius-lg); background:linear-gradient(135deg, rgba(0,212,255,0.1), transparent 40%, transparent 60%, rgba(0,212,255,0.05)); pointer-events:none; z-index:-1; }

/* Animated border on login */
@keyframes borderGlow { 0%,100% { border-color:rgba(0,212,255,0.2); box-shadow:var(--shadow-lg), 0 0 20px rgba(0,212,255,0.1); } 50% { border-color:rgba(0,212,255,0.35); box-shadow:var(--shadow-lg), 0 0 35px rgba(0,212,255,0.15); } }
.login-box { animation: borderGlow 4s ease-in-out infinite; }

/* Dashboard content above arc reactor */
#page-dashboard .dash-live-bar,
#page-dashboard .grid,
#page-dashboard .card { position:relative; z-index:1; }

/* Page transitions */
.page { animation: pageIn 0.3s ease; }
@keyframes pageIn { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }

/* Sidebar logo enhanced */
.sidebar-logo .logo-icon { background:rgba(0,212,255,0.05); }

/* Data readout animation on stat values */
@keyframes dataFlicker { 0%,100% { opacity:1; } 92% { opacity:1; } 93% { opacity:0.7; } 94% { opacity:1; } 96% { opacity:0.8; } 97% { opacity:1; } }
.stat-value { animation: dataFlicker 6s ease-in-out infinite; }

/* Section open animation */
.s-section-body.open { animation: sectionReveal 0.3s ease; }
@keyframes sectionReveal { from { opacity:0.5; } to { opacity:1; } }

/* HUD label style for form labels */
.form-group label { color:rgba(0,212,255,0.45); }

/* Enhanced chip grid */
.chip-opt { border-color:rgba(0,212,255,0.1); }
.chip-opt:hover { border-color:rgba(0,212,255,0.25); background:rgba(0,212,255,0.04); }
.chip-opt.selected { background:rgba(0,212,255,0.08); border-color:rgba(0,212,255,0.4); }
</style>
</head>
<body>

<!-- SETUP (erstmaliger Aufruf) -->
<div id="setupScreen" class="login-screen" style="display:none;">
  <div class="login-box">
    <div class="login-icon">&#9881;</div>
    <h1>JARVIS</h1>
    <p>Ersteinrichtung — PIN festlegen</p>
    <input type="password" id="setupPin" maxlength="16" placeholder="PIN waehlen"
           onkeydown="if(event.key==='Enter')document.getElementById('setupPinConfirm').focus()">
    <input type="password" id="setupPinConfirm" maxlength="16" placeholder="PIN bestaetigen"
           onkeydown="if(event.key==='Enter')doSetup()">
    <button onclick="doSetup()">PIN setzen</button>
    <div id="setupError" class="login-error"></div>
  </div>
</div>

<!-- RECOVERY KEY anzeigen (nach Setup) -->
<div id="recoveryScreen" class="login-screen" style="display:none;">
  <div class="login-box">
    <div class="login-icon">&#128273;</div>
    <h1>Recovery-Key</h1>
    <p class="recovery-hint">Diesen Schluessel sicher aufbewahren!</p>
    <p class="recovery-desc">Falls du deinen PIN vergisst, kannst du ihn nur mit diesem Key zuruecksetzen. Er wird nur einmal angezeigt.</p>
    <div id="recoveryKeyDisplay" class="recovery-key-display"></div>
    <button onclick="recoveryAcknowledged()">Ich habe den Key gespeichert</button>
  </div>
</div>

<!-- LOGIN -->
<div id="loginScreen" class="login-screen" style="display:none;">
  <div class="login-box">
    <div class="login-hud-ring">
      <svg viewBox="0 0 120 120">
        <circle class="login-hud-arc" cx="60" cy="60" r="54" />
        <circle class="login-hud-arc-inner" cx="60" cy="60" r="46" />
      </svg>
    </div>
    <div class="login-corner tl"></div>
    <div class="login-corner tr"></div>
    <div class="login-corner bl"></div>
    <div class="login-corner br"></div>
    <div class="login-scan-line"></div>
    <h1>JARVIS</h1>
    <p>MindHome Assistant</p>
    <input type="password" id="pinInput" maxlength="16" placeholder="PIN" autofocus
           onkeydown="if(event.key==='Enter')doLogin()">
    <button onclick="doLogin()">Authentifizieren</button>
    <div id="loginError" class="login-error"></div>
    <div class="forgot-pin">
      <a href="#" onclick="showResetScreen();return false;">PIN vergessen?</a>
    </div>
  </div>
</div>

<!-- PIN RESET -->
<div id="resetScreen" class="login-screen" style="display:none;">
  <div class="login-box">
    <div class="login-icon">&#128273;</div>
    <h1>PIN zuruecksetzen</h1>
    <p>Recovery-Key eingeben</p>
    <input type="text" id="resetRecoveryKey" maxlength="16" placeholder="Recovery-Key" class="reset-input"
           onkeydown="if(event.key==='Enter')document.getElementById('resetNewPin').focus()">
    <input type="password" id="resetNewPin" maxlength="16" placeholder="Neuer PIN"
           onkeydown="if(event.key==='Enter')document.getElementById('resetNewPinConfirm').focus()">
    <input type="password" id="resetNewPinConfirm" maxlength="16" placeholder="Neuer PIN bestaetigen"
           onkeydown="if(event.key==='Enter')doResetPin()">
    <button onclick="doResetPin()">PIN zuruecksetzen</button>
    <div id="resetError" class="login-error"></div>
    <div class="forgot-pin">
      <a href="#" onclick="showLoginScreen();return false;">Zurueck zur Anmeldung</a>
    </div>
  </div>
</div>

<!-- NEUER RECOVERY KEY (nach Reset) -->
<div id="newRecoveryScreen" class="login-screen" style="display:none;">
  <div class="login-box">
    <div class="login-icon">&#128273;</div>
    <h1>Neuer Recovery-Key</h1>
    <p class="recovery-hint">Neuen Schluessel sicher aufbewahren!</p>
    <p class="recovery-desc">Der alte Recovery-Key ist ungueltig. Dieser neue Key wird nur einmal angezeigt.</p>
    <div id="newRecoveryKeyDisplay" class="recovery-key-display"></div>
    <button onclick="newRecoveryAcknowledged()">Ich habe den Key gespeichert</button>
  </div>
</div>

<!-- APP -->
<div id="app" class="app">
  <div class="sidebar-backdrop" id="sidebarBackdrop" onclick="closeSidebar()"></div>
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-logo">
      <div class="logo-icon">J</div>
      <div><h2>JARVIS</h2><span>MindHome Assistant</span></div>
    </div>
    <nav class="sidebar-nav" id="sidebarNav">
      <div class="nav-item active" data-page="dashboard"><span class="nav-icon">&#9632;</span>Dashboard</div>
      <div class="nav-divider"></div>
      <!-- Haus & Raeume -->
      <div class="nav-group">
        <div class="nav-group-header" onclick="toggleNavGroup(this)"><span>Haus & Raeume</span><span class="nav-group-arrow">&#9654;</span></div>
        <div class="nav-group-items">
          <div class="nav-item" data-page="presence"><span class="nav-icon">&#128205;</span>Anwesenheit</div>
          <div class="nav-item" data-page="settings" data-tab="tab-rooms"><span class="nav-icon">&#127968;</span>Raeume & Speaker</div>
          <div class="nav-item" data-page="settings" data-tab="tab-lights"><span class="nav-icon">&#128161;</span>Licht</div>
          <div class="nav-item" data-page="settings" data-tab="tab-devices"><span class="nav-icon">&#128268;</span>Geraete</div>
          <div class="nav-item" data-page="settings" data-tab="tab-covers"><span class="nav-icon">&#129695;</span>Rolllaeden</div>
          <div class="nav-item" data-page="settings" data-tab="tab-vacuum"><span class="nav-icon">&#129529;</span>Saugroboter</div>
          <div class="nav-item" data-page="entities"><span class="nav-icon">&#8801;</span>Entities</div>
        </div>
      </div>
      <!-- KI & Sprache -->
      <div class="nav-group">
        <div class="nav-group-header" onclick="toggleNavGroup(this)"><span>KI & Sprache</span><span class="nav-group-arrow">&#9654;</span></div>
        <div class="nav-group-items">
          <div class="nav-item" data-page="settings" data-tab="tab-personality"><span class="nav-icon">&#127917;</span>KI-Modelle & Stil</div>
          <div class="nav-item" data-page="settings" data-tab="tab-mood"><span class="nav-icon">&#128578;</span>Stimmung</div>
          <div class="nav-item" data-page="settings" data-tab="tab-voice"><span class="nav-icon">&#128266;</span>Stimme & TTS</div>
        </div>
      </div>
      <!-- Gedaechtnis & Wissen -->
      <div class="nav-group">
        <div class="nav-group-header" onclick="toggleNavGroup(this)"><span>Gedaechtnis & Wissen</span><span class="nav-group-arrow">&#9654;</span></div>
        <div class="nav-group-items">
          <div class="nav-item" data-page="memory"><span class="nav-icon">&#129504;</span>Gedaechtnis</div>
          <div class="nav-item" data-page="settings" data-tab="tab-memory"><span class="nav-icon">&#128218;</span>Gedaechtnis-Config</div>
          <div class="nav-item" data-page="knowledge"><span class="nav-icon">&#128218;</span>Wissen</div>
          <div class="nav-item" data-page="recipes"><span class="nav-icon">&#127859;</span>Rezepte</div>
        </div>
      </div>
      <!-- Automatisierung -->
      <div class="nav-group">
        <div class="nav-group-header" onclick="toggleNavGroup(this)"><span>Automatisierung</span><span class="nav-group-arrow">&#9654;</span></div>
        <div class="nav-group-items">
          <div class="nav-item" data-page="settings" data-tab="tab-routines"><span class="nav-icon">&#127748;</span>Routinen</div>
          <div class="nav-item" data-page="settings" data-tab="tab-proactive"><span class="nav-icon">&#128276;</span>Proaktiv</div>
          <div class="nav-item" data-page="settings" data-tab="tab-cooking"><span class="nav-icon">&#127859;</span>Koch-Assistent</div>
          <div class="nav-item" data-page="settings" data-tab="tab-followme"><span class="nav-icon">&#128694;</span>Follow-Me</div>
          <div class="nav-item" data-page="settings" data-tab="tab-jarvis"><span class="nav-icon">&#129497;</span>Jarvis-Features</div>
          <div class="nav-item" data-page="settings" data-tab="tab-eastereggs"><span class="nav-icon">&#127881;</span>Easter Eggs</div>
        </div>
      </div>
      <!-- System -->
      <div class="nav-group">
        <div class="nav-group-header" onclick="toggleNavGroup(this)"><span>System</span><span class="nav-group-arrow">&#9654;</span></div>
        <div class="nav-group-items">
          <div class="nav-item" data-page="settings" data-tab="tab-general"><span class="nav-icon">&#9881;</span>Allgemein</div>
          <div class="nav-item" data-page="settings" data-tab="tab-autonomie"><span class="nav-icon">&#129302;</span>Autonomie</div>
          <div class="nav-item" data-page="settings" data-tab="tab-security"><span class="nav-icon">&#128274;</span>Sicherheit & Notfall</div>
          <div class="nav-item" data-page="settings" data-tab="tab-house-status"><span class="nav-icon">&#127777;</span>Haus-Status & Health</div>
          <div class="nav-item" data-page="settings" data-tab="tab-system"><span class="nav-icon">&#128296;</span>System & Updates</div>
          <div class="nav-item" data-page="logs"><span class="nav-icon">&#9776;</span>Logs</div>
          <div class="nav-item" data-page="errors"><span class="nav-icon">&#9888;</span>Fehler<span id="errBadge" class="err-badge" style="display:none;">0</span></div>
        </div>
      </div>
    </nav>
    <div class="sidebar-footer">MindHome Assistant v1.4.1</div>
  </aside>

  <div class="main">
    <header class="main-header">
      <div class="flex-center gap-md">
        <div class="mobile-toggle" onclick="toggleSidebar()">&#9776;</div>
        <h1 id="pageTitle">Dashboard</h1>
      </div>
      <div class="flex-center gap-md">
        <span id="statusBadge" class="badge badge-ok">Online</span>
        <button class="btn btn-sm btn-secondary" onclick="doLogout()">Abmelden</button>
      </div>
    </header>

    <div class="main-content">
      <!-- ============ DASHBOARD ============ -->
      <div id="page-dashboard" class="page active">
        <!-- Arc Reactor Background -->
        <svg class="arc-reactor-bg" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
          <circle cx="200" cy="200" r="180" fill="none" stroke="rgba(0,212,255,0.04)" stroke-width="0.5"/>
          <circle cx="200" cy="200" r="150" fill="none" stroke="rgba(0,212,255,0.03)" stroke-width="0.5" stroke-dasharray="8 12"/>
          <circle cx="200" cy="200" r="120" fill="none" stroke="rgba(0,212,255,0.05)" stroke-width="0.5" stroke-dasharray="4 8 2 8" class="arc-ring-1"/>
          <circle cx="200" cy="200" r="90" fill="none" stroke="rgba(0,212,255,0.04)" stroke-width="0.5" stroke-dasharray="12 6 4 6" class="arc-ring-2"/>
          <circle cx="200" cy="200" r="60" fill="none" stroke="rgba(0,212,255,0.06)" stroke-width="0.5" stroke-dasharray="3 15" class="arc-ring-3"/>
          <circle cx="200" cy="200" r="30" fill="none" stroke="rgba(0,212,255,0.03)" stroke-width="1"/>
          <circle cx="200" cy="200" r="4" fill="rgba(0,212,255,0.08)"/>
        </svg>
        <div class="dash-live-bar">
          <span id="liveIndicator" class="live-dot"></span>
          <span class="text-muted-sm" id="liveTimestamp">—</span>
          <span id="whisperBadge" class="whisper-badge">Flüstermodus</span>
        </div>
        <div id="dashStats" class="grid grid-4"></div>
        <div class="grid grid-2 mt-md">
          <div class="card"><div class="card-header"><h3>Komponenten</h3></div><div id="compList"></div></div>
          <div class="card"><div class="card-header"><h3>Status</h3></div><div id="moodInfo"></div></div>
        </div>
        <div class="card mt-md">
          <div class="card-header flex-between">
            <h3>Raumklima</h3>
            <div class="trend-period-bar" id="trendPeriodBar">
              <button class="active" onclick="loadHealthTrends(24)">24h</button>
              <button onclick="loadHealthTrends(48)">48h</button>
              <button onclick="loadHealthTrends(168)">7 Tage</button>
            </div>
          </div>
          <div id="healthTrendsContainer" class="trend-card"></div>
        </div>
      </div>

      <!-- ============ SETTINGS ============ -->
      <div id="page-settings" class="page">
        <div class="section-header">
          <div><h2 id="settingsTitle">Einstellungen</h2><p id="settingsSub">Alle Konfigurationen aus settings.yaml</p></div>
          <span id="autoSaveStatus" class="auto-save-status"></span>
        </div>
        <div id="settingsContent"></div>
      </div>

      <!-- ============ PRESENCE ============ -->
      <div id="page-presence" class="page">
        <div class="section-header">
          <div><h2>Anwesenheit</h2><p>Wer ist zuhause, wer unterwegs?</p></div>
          <button class="btn btn-secondary" onclick="loadPresence()">Aktualisieren</button>
        </div>
        <div id="presenceSummary" class="grid grid-3" style="margin-bottom:16px;"></div>
        <div id="presencePersons" class="grid grid-2" style="margin-bottom:16px;"></div>
        <div class="card" style="margin-bottom:16px;">
          <div class="card-header"><h3>Einstellungen</h3></div>
          <div id="presenceSettings" style="padding:16px;"></div>
        </div>
        <div style="text-align:center;color:var(--text-muted);font-size:12px;margin-top:8px;" id="presenceRefreshHint">Status wird alle 15 Sekunden aktualisiert</div>
      </div>

      <!-- ============ ENTITIES ============ -->
      <div id="page-entities" class="page">
        <div class="section-header">
          <div><h2>Home Assistant Entities</h2><p>Alle Entities — klicke zum Kopieren</p></div>
          <button class="btn btn-secondary" onclick="loadEntities()">Aktualisieren</button>
        </div>
        <div class="entity-filter-bar">
          <div class="form-group mb-0">
            <select id="entityDomainFilter" onchange="filterEntities()"><option value="">Alle Domains</option></select>
          </div>
          <div class="form-group mb-0">
            <input type="text" id="entitySearchInput" placeholder="Entity suchen..." oninput="filterEntities()">
          </div>
        </div>
        <div class="card entity-list-card"><div id="entityBrowser" class="entity-list"></div></div>
      </div>

      <!-- ============ MEMORY (Fakten + Episoden) ============ -->
      <div id="page-memory" class="page">
        <div class="section-header">
          <div><h2>Gedaechtnis</h2><p>Fakten & Episoden verwalten</p></div>
          <div style="display:flex;gap:8px;">
            <button class="btn btn-secondary" onclick="loadMemoryPage()">Aktualisieren</button>
            <button class="btn btn-danger" onclick="showMemoryResetDialog()">Komplett zuruecksetzen</button>
            <button class="btn btn-danger" onclick="showFactoryResetDialog()" style="background:#b91c1c;border-color:#b91c1c;" title="ALLES zuruecksetzen: Gedaechtnis, Korrekturen, Lernmuster, Feedback — Einstellungen bleiben">Grundeinstellung</button>
          </div>
        </div>
        <div id="memStats" class="grid grid-3" style="margin-bottom:16px;"></div>

        <!-- Fakten -->
        <div class="card" style="margin-bottom:16px;">
          <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;">
            <h3>Fakten</h3>
            <div style="display:flex;gap:8px;align-items:center;">
              <select id="memFactFilter" onchange="filterMemoryFacts()" style="padding:6px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg-secondary);color:var(--text-primary);font-size:13px;">
                <option value="">Alle Kategorien</option>
              </select>
              <select id="memPersonFilter" onchange="filterMemoryFacts()" style="padding:6px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg-secondary);color:var(--text-primary);font-size:13px;">
                <option value="">Alle Personen</option>
              </select>
              <button class="btn btn-danger" id="memFactDeleteBtn" onclick="deleteSelectedFacts()" style="display:none;font-size:12px;padding:5px 12px;">Loeschen</button>
            </div>
          </div>
          <div id="memFacts" style="max-height:500px;overflow-y:auto;"></div>
        </div>

        <!-- Episoden -->
        <div class="card">
          <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;">
            <h3>Episoden</h3>
            <div style="display:flex;gap:8px;align-items:center;">
              <input type="text" id="memEpisodeSearch" placeholder="Episoden durchsuchen..." oninput="filterMemoryEpisodes()" style="padding:6px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg-secondary);color:var(--text-primary);font-size:13px;width:200px;">
              <button class="btn btn-danger" id="memEpDeleteBtn" onclick="deleteSelectedEpisodes()" style="display:none;font-size:12px;padding:5px 12px;">Loeschen</button>
            </div>
          </div>
          <div id="memEpisodes" style="max-height:500px;overflow-y:auto;"></div>
        </div>
      </div>

      <!-- Memory Reset Dialog (Overlay) -->
      <div id="memResetOverlay" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:9999;align-items:center;justify-content:center;">
        <div style="background:var(--bg-primary);border:1px solid var(--danger);border-radius:12px;padding:28px;max-width:400px;width:90%;">
          <h3 style="color:var(--danger);margin-bottom:12px;">Gedaechtnis zuruecksetzen</h3>
          <p style="margin-bottom:16px;color:var(--text-muted);font-size:14px;">
            ACHTUNG: Alle Fakten, Episoden und Konversationen werden unwiderruflich geloescht!
            Gib zur Bestaetigung deinen PIN ein.
          </p>
          <input type="password" id="memResetPin" placeholder="PIN eingeben" style="width:100%;padding:10px;border-radius:6px;border:1px solid var(--border);background:var(--bg-secondary);color:var(--text-primary);font-size:16px;margin-bottom:12px;box-sizing:border-box;" />
          <div id="memResetError" style="color:var(--danger);font-size:13px;margin-bottom:10px;display:none;"></div>
          <div style="display:flex;gap:8px;justify-content:flex-end;">
            <button class="btn btn-secondary" onclick="hideMemoryResetDialog()">Abbrechen</button>
            <button class="btn btn-danger" id="memResetConfirmBtn" onclick="confirmMemoryReset()">Zuruecksetzen</button>
          </div>
        </div>
      </div>

      <!-- Factory Reset Dialog (Overlay) -->
      <div id="factoryResetOverlay" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:9999;align-items:center;justify-content:center;">
        <div style="background:var(--bg-primary);border:2px solid #b91c1c;border-radius:12px;padding:28px;max-width:440px;width:90%;">
          <h3 style="color:#b91c1c;margin-bottom:12px;">&#9888; Jarvis auf Grundeinstellung</h3>
          <p style="margin-bottom:12px;color:var(--text-muted);font-size:14px;">
            <strong>ACHTUNG:</strong> Dieser Reset loescht <em>alles Gelernte</em> unwiderruflich:
          </p>
          <ul style="margin:0 0 16px 16px;color:var(--text-muted);font-size:13px;line-height:1.7;">
            <li>Gedaechtnis (Fakten, Episoden, Konversationen)</li>
            <li>Korrektur-Regeln &amp; Lernmuster</li>
            <li>Feedback-Scores &amp; Stimmungs-State</li>
            <li>Besucher- &amp; Speaker-Profile</li>
            <li>Wissensdatenbank &amp; Rezepte</li>
          </ul>
          <p style="margin-bottom:16px;color:var(--text-primary);font-size:14px;font-weight:500;">
            Einstellungen, Raeume und Routinen-Config bleiben erhalten.
          </p>
          <label style="display:flex;align-items:center;gap:8px;margin-bottom:16px;cursor:pointer;font-size:13px;color:var(--text-muted);">
            <input type="checkbox" id="factoryResetUploads" style="width:16px;height:16px;">
            Auch Uploads loeschen
          </label>
          <input type="password" id="factoryResetPin" placeholder="PIN eingeben" style="width:100%;padding:10px;border-radius:6px;border:1px solid var(--border);background:var(--bg-secondary);color:var(--text-primary);font-size:16px;margin-bottom:12px;box-sizing:border-box;" />
          <div id="factoryResetError" style="color:#b91c1c;font-size:13px;margin-bottom:10px;display:none;"></div>
          <div style="display:flex;gap:8px;justify-content:flex-end;">
            <button class="btn btn-secondary" onclick="hideFactoryResetDialog()">Abbrechen</button>
            <button class="btn btn-danger" id="factoryResetConfirmBtn" onclick="confirmFactoryReset()" style="background:#b91c1c;border-color:#b91c1c;">Grundeinstellung</button>
          </div>
        </div>
      </div>

      <!-- ============ KNOWLEDGE ============ -->
      <div id="page-knowledge" class="page">
        <div class="section-header">
          <div><h2>Wissensdatenbank</h2><p>Dateien in config/knowledge/ — RAG-Quelle</p></div>
          <div style="display:flex;gap:8px;">
            <button class="btn btn-primary" onclick="ingestKnowledge()">Neu einlesen</button>
            <button class="btn btn-danger" onclick="rebuildKnowledge()" title="Collection loeschen und alle Dateien mit aktuellem Embedding-Modell neu einlesen">Rebuild</button>
          </div>
        </div>
        <div id="kbStats" class="grid grid-3" style="margin-bottom:16px;"></div>
        <div class="card" style="margin-bottom:16px;">
          <div id="kbDropzone" style="border:2px dashed var(--border);border-radius:10px;padding:28px 16px;text-align:center;cursor:pointer;transition:all .2s;" onclick="document.getElementById('kbFileInput').click()">
            <div style="font-size:28px;margin-bottom:6px;">&#128228;</div>
            <div style="font-size:14px;font-weight:500;">Datei hochladen</div>
            <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Drag & Drop oder klicken — .txt .md .pdf .csv — max 10 MB</div>
          </div>
          <input type="file" id="kbFileInput" accept=".txt,.md,.pdf,.csv" style="display:none;" onchange="uploadKbFile(this.files[0])" />
        </div>
        <div class="card"><div class="card-header"><h3>Dateien</h3></div><div id="kbFiles"></div></div>
        <div class="card" style="margin-top:16px;">
          <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;">
            <h3>Wissensinhalte</h3>
            <div style="display:flex;gap:8px;align-items:center;">
              <select id="kbSourceFilter" onchange="loadKbChunks()" style="padding:6px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg-secondary);color:var(--text-primary);font-size:13px;">
                <option value="">Alle Quellen</option>
              </select>
              <button class="btn btn-danger" id="kbDeleteBtn" onclick="deleteSelectedChunks()" style="display:none;font-size:12px;padding:5px 12px;">Ausgewaehlte loeschen</button>
            </div>
          </div>
          <div id="kbChunks" style="max-height:500px;overflow-y:auto;"></div>
        </div>
      </div>

      <!-- ============ RECIPES ============ -->
      <div id="page-recipes" class="page">
        <div class="section-header">
          <div><h2>Rezeptdatenbank</h2><p>Eigene Rezepte fuer den Koch-Assistenten &mdash; config/recipes/</p></div>
          <div style="display:flex;gap:8px;">
            <button class="btn btn-primary" onclick="ingestRecipes()">Neu einlesen</button>
            <button class="btn btn-danger" onclick="rebuildRecipes()" title="Collection loeschen und alle Dateien mit aktuellem Embedding-Modell neu einlesen">Rebuild</button>
          </div>
        </div>
        <div id="recipeStats" class="grid grid-3" style="margin-bottom:16px;"></div>
        <div class="card" style="margin-bottom:16px;">
          <div id="recipeDropzone" style="border:2px dashed var(--border);border-radius:10px;padding:28px 16px;text-align:center;cursor:pointer;transition:all .2s;" onclick="document.getElementById('recipeFileInput').click()">
            <div style="font-size:28px;margin-bottom:6px;">&#127859;</div>
            <div style="font-size:14px;font-weight:500;">Rezept hochladen</div>
            <div style="font-size:12px;color:var(--text-muted);margin-top:4px;">Drag &amp; Drop oder klicken &mdash; .txt .md .pdf .csv &mdash; max 10 MB</div>
          </div>
          <input type="file" id="recipeFileInput" accept=".txt,.md,.pdf,.csv" style="display:none;" onchange="uploadRecipeFile(this.files[0])" />
        </div>
        <div class="card"><div class="card-header"><h3>Rezeptdateien</h3></div><div id="recipeFiles"></div></div>
        <div class="card" style="margin-top:16px;">
          <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;">
            <h3>Rezeptinhalte</h3>
            <div style="display:flex;gap:8px;align-items:center;">
              <select id="recipeSourceFilter" onchange="loadRecipeChunks()" style="padding:6px 10px;border-radius:6px;border:1px solid var(--border);background:var(--bg-secondary);color:var(--text-primary);font-size:13px;">
                <option value="">Alle Quellen</option>
              </select>
              <button class="btn btn-danger" id="recipeDeleteBtn" onclick="deleteSelectedRecipeChunks()" style="display:none;font-size:12px;padding:5px 12px;">Ausgewaehlte loeschen</button>
            </div>
          </div>
          <div id="recipeChunks" style="max-height:500px;overflow-y:auto;"></div>
        </div>
      </div>

      <!-- ============ LOGS ============ -->
      <div id="page-logs" class="page">
        <div class="section-header">
          <div><h2>Protokolle</h2><p>Gespraeche und Audit-Ereignisse</p></div>
          <button class="btn btn-secondary" onclick="currentLogTab==='conversations'?loadLogs():currentLogTab==='activity'?loadActivity():currentLogTab==='protocol'?loadProtocol():loadAudit()">Aktualisieren</button>
        </div>
        <div class="tab-bar" id="logsTabBar" style="margin-bottom:14px;">
          <div class="tab-item active" data-logtab="conversations" onclick="switchLogTab('conversations')">Gespraeche</div>
          <div class="tab-item" data-logtab="activity" onclick="switchLogTab('activity')">Aktivitaet</div>
          <div class="tab-item" data-logtab="protocol" onclick="switchLogTab('protocol')">Protokoll</div>
          <div class="tab-item" data-logtab="audit" onclick="switchLogTab('audit')">Audit-Log</div>
        </div>

        <!-- Aktivitaet Filter -->
        <div id="activityFilters" style="display:none;margin-bottom:14px;">
          <div class="card" style="padding:12px;">
            <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
              <input id="activitySearch" type="text" class="input" placeholder="Suchen..."
                style="flex:1 1 200px;min-width:150px;" oninput="filterActivity()">
              <select id="activityModule" class="input" style="flex:0 1 160px;" onchange="loadActivity()">
                <option value="">Alle Module</option>
              </select>
              <select id="activityLevel" class="input" style="flex:0 1 120px;" onchange="loadActivity()">
                <option value="">Alle Level</option>
                <option value="INFO">Info</option>
                <option value="WARNING">Warnung</option>
                <option value="ERROR">Fehler</option>
              </select>
              <button class="btn btn-secondary" onclick="loadActivity()" title="Aktualisieren">&#128260;</button>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px;">
              <span id="activityCount" style="font-size:11px;color:var(--text-muted);">0 Eintraege</span>
              <div style="display:flex;gap:12px;align-items:center;">
                <label style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--text-muted);cursor:pointer;">
                  <input type="checkbox" id="activityLive" onchange="toggleActivityLive()"> Live
                </label>
                <button class="btn btn-secondary" style="font-size:11px;padding:2px 8px;" onclick="clearActivity()">Leeren</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Protokoll Filter -->
        <div id="protocolFilters" style="display:none;margin-bottom:14px;">
          <div class="card" style="padding:12px;">
            <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
              <input id="protocolSearch" type="text" class="input" placeholder="Suchen..."
                style="flex:1 1 200px;min-width:150px;" oninput="filterProtocol()">
              <select id="protocolType" class="input" style="flex:0 1 180px;" onchange="loadProtocol()">
                <option value="">Alle Typen</option>
                <option value="jarvis_action">Jarvis-Aktionen</option>
                <option value="automation">Automationen</option>
                <option value="observation">Beobachtungen</option>
                <option value="quick_action">Schnellaktionen</option>
                <option value="tts">Durchsagen (TTS)</option>
                <option value="notification">Benachrichtigungen</option>
                <option value="anomaly">Anomalien</option>
                <option value="system">System</option>
              </select>
              <select id="protocolPeriod" class="input" style="flex:0 1 140px;" onchange="loadProtocol()">
                <option value="today">Heute</option>
                <option value="7d" selected>7 Tage</option>
                <option value="30d">30 Tage</option>
                <option value="all">Alle</option>
              </select>
              <button class="btn btn-secondary" onclick="loadProtocol()" title="Aktualisieren">&#128260;</button>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px;">
              <span id="protocolCount" style="font-size:11px;color:var(--text-muted);">0 Eintraege</span>
              <label style="display:flex;align-items:center;gap:6px;font-size:12px;color:var(--text-muted);cursor:pointer;">
                <input type="checkbox" id="protocolLive" onchange="toggleProtocolLive()"> Live
              </label>
            </div>
          </div>
        </div>

        <div class="card" style="padding:0;">
          <div id="logsContainer"></div>
          <div id="activityContainer" style="display:none;"></div>
          <div id="protocolContainer" style="display:none;"></div>
          <div id="auditContainer" style="display:none;"></div>
        </div>
      </div>

      <div id="page-errors" class="page">
        <div class="section-header">
          <div><h2>Fehlerspeicher</h2><p>Letzte Warnungen und Fehler des Assistenten</p></div>
          <div class="err-filter-bar">
            <button class="btn btn-secondary active-filter" id="errFilterAll" onclick="filterErrors('')">Alle</button>
            <button class="btn btn-secondary" id="errFilterError" onclick="filterErrors('ERROR')">Fehler</button>
            <button class="btn btn-secondary" id="errFilterWarn" onclick="filterErrors('WARNING')">Warnungen</button>
            <button class="btn btn-secondary" onclick="loadErrors()">Aktualisieren</button>
            <button class="btn btn-danger" onclick="clearErrors()">Leeren</button>
          </div>
        </div>
        <div class="card" style="padding:0;"><div id="errorsContainer"></div></div>
        <div style="margin-top:8px;font-size:11px;color:var(--text-muted);" id="errorsInfo"></div>
      </div>
    </div>
  </div>
</div>

<!-- Help Modal -->
<div class="help-modal-backdrop" id="helpModalBackdrop" onclick="closeHelpModal()">
  <div class="help-modal" onclick="event.stopPropagation()">
    <button class="help-modal-close" onclick="closeHelpModal()">&#10005;</button>
    <h3 id="helpModalTitle"></h3>
    <p id="helpModalText"></p>
    <div class="help-detail" id="helpModalDetail" style="display:none;"></div>
  </div>
</div>

<div id="toast" class="toast"></div>

<!-- BOOT SCREEN -->
<div id="bootScreen" class="boot-screen" style="display:none;">
  <div class="boot-hud">
    <svg class="boot-circle" viewBox="0 0 200 200">
      <circle class="boot-ring" cx="100" cy="100" r="90" />
      <circle class="boot-ring-fill" cx="100" cy="100" r="90" />
    </svg>
    <svg class="boot-ring-outer" viewBox="0 0 200 200">
      <circle cx="100" cy="100" r="96" fill="none" stroke="rgba(0,212,255,0.12)" stroke-width="0.5" />
      <circle cx="100" cy="100" r="96" fill="none" stroke="rgba(0,212,255,0.4)" stroke-width="1" stroke-dasharray="12 8 4 8" stroke-linecap="round" />
    </svg>
    <svg class="boot-ring-inner" viewBox="0 0 200 200">
      <circle cx="100" cy="100" r="70" fill="none" stroke="rgba(0,212,255,0.3)" stroke-width="0.8" stroke-dasharray="6 14 2 14" />
      <circle cx="100" cy="100" r="55" fill="none" stroke="rgba(0,212,255,0.15)" stroke-width="0.5" stroke-dasharray="3 20" />
    </svg>
    <div class="boot-logo">JARVIS</div>
  </div>
  <div class="boot-text" id="bootText"></div>
  <div class="boot-systems" id="bootSystems"></div>
</div>

<script src="app.js"></script>
</body>
</html>
